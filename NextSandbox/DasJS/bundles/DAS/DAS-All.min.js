var DasAjaxReloadOptions,DasAjaxReload;String.prototype.DASContains=function(n){return this.indexOf(n)!==-1},function(n){n.fn.extend({DASValue:function(){var t=n(this),i,r;return t.is("input, select, textarea")?arguments.length>0?(i=arguments[0],t.val(i),i):t.val():arguments.length>0?(r=arguments[0],t.html(r),r):t.html()},DisableDatePicker:function(){var t=n(this);t.datepicker("destroy");t.attr("readonly","readonly")},EnableDatePicker:function(){var t=n(this);t.attr("autocomplete","off");t.removeAttr("readonly");t.datepicker()},GetJsonList:function(){var t=n(this),i,r;return!t||t.length===0||!t.is("select")?null:(i=t.find("option"),r=n.map(i,function(t){var i=n(t);return{Value:i.attr("value"),Text:i.text(),Selected:i.prop("selected"),Disabled:i.prop("disabled")}}),r)},FillJsonList:function(t){var u=n(this),f,i,r;if(u&&u.length!==0&&u.is("select")){u.empty();for(f in t)i=t[f],r=n("<option>"),i.hasOwnProperty("Value")&&r.val(i.Value),i.hasOwnProperty("Selected")&&r.prop("selected",i.Selected),i.hasOwnProperty("Disabled")&&r.prop("disabled",i.Disabled),i.hasOwnProperty("Text")&&(r.text(i.Text),u.append(r))}}})}(jQuery);Number.prototype.DASRound=function(n){var i=this,t;return(n===null||n<0)&&(n=0),t=Math.pow(10,n),Math.round(i*t)/t};var zeroOrValue=function(n){return n===null||/^\s*$/.test(n)?0:n.replace?parseFloat(n.replace(",",".")):n},parseLocalFloat=function(n){return n?parseFloat(n.split(" ").join("").replace(",",".")):null},parseLocalInt=function(n){return n?parseInt(n.split(" ").join("").replace(",",".")):null},parseBool=function(n){return typeof n=="boolean"?n:typeof n=="string"?n.toUpperCase()==="TRUE":typeof n=="number"?n?!0:!1:!1},parseLocalDate=function(n){return n},getFuncFromSettingsOrDefault=function(n,t,i){return n?t?n.hasOwnProperty(t)&&typeof n[t]=="function"?n[t]:i:i:i},GenericAjaxModel=function(){var n=function(){return{}},t={getFunc:function(n){return n},getValue:function(n){return n?$(n).DASValue():null},setValue:function(n,t){$(n).DASValue(t)},onChangeFunc:function(n){return n}};return n.prototype.CreateProperty=function(n,i){var u=this,r;if(i){if(!i.hasOwnProperty("selector")&&!i.hasOwnProperty("getValue")){console.log("Erreur GenericAjaxModel.CreateProperty : ni selector, ni getValue declare pour "+n);return}r=function(){return $(i.selector)};i.hasOwnProperty("container")&&(r=function(){return $(i.container).find(i.selector)});var f=getFuncFromSettingsOrDefault(i,"getFunc",t.getFunc),e=getFuncFromSettingsOrDefault(i,"getValue",t.getValue),o=getFuncFromSettingsOrDefault(i,"setValue",t.setValue),s=getFuncFromSettingsOrDefault(i,"onChangeFunc",t.onChangeFunc);Object.defineProperty(u,n,{get:function(){var n=r(),t=e(n);return f(t)},set:function(n){var t=r();o(t,n);s(n)}})}},n.prototype.CreateProperties=function(n){var i,t;this.propertiesDefinition=n;i=this;for(t in n)n.hasOwnProperty(t)&&i.CreateProperty(t,n[t])},n.prototype.toDTO=function(n){var f=Object.getOwnPropertyNames(this),r=null,u,i,t;for(n&&(r="|"+n.join("|")+"|"),u={},i=0;i<f.length;i++)(t=f[i],this.hasOwnProperty(t))&&typeof this[t]!="function"&&(r&&r.indexOf("|"+t+"|")===-1||t!=="toDTO"&&t!=="propertiesDefinition"&&(u[t]=this[t]));return u},n.prototype.FillFromAjax=function(n,t,i){t=t||"GET";var r=this;return n?$.ajax({url:n,type:t,data:r.toDTO(i)}).done(function(n){$.map(n,function(n,t){r[t]=n})}):null},n}();$(document).ready(function(){$("*[data-das-onchange-id]").each(function(n,t){var u=$(t),i=u.data(),r;if(i.hasOwnProperty("dasOnchangeId")&&i.hasOwnProperty("dasOnchangeUrl")&&i.hasOwnProperty("dasOnchangeName")){r=$("#"+i.dasOnchangeId);r.on("change",function(){var n=r.val(),t=i.dasOnchangeUrl.addUrlParam(i.dasOnchangeName,n);u.load(t)})}})});DasAjaxReloadOptions=function(){this.targetSelector=null;this.ajaxUrl=null;this.ajaxType="POST";this.ajaxDataType="html";this.GetDataDelegate=null;this.triggerChangeSeletors=null;this.delegateBeforeAjax=null;this.delegateSuccess=null;this.delegateError=null;this.execute=!1};DasAjaxReload=function(n,t){var i,r,f,s,u,e,o;if(t&&(i=t instanceof DasAjaxReloadOptions?t:$.extend(!0,new DasAjaxReloadOptions,t),i.ajaxUrl)&&$(i.targetSelector)&&i.triggerChangeSeletors&&(r=this,this.GetAjaxUrl=function(){var n=i.ajaxUrl;return n?typeof n=="function"?n():n:null},this.GetData=function(){var n=i.GetDataDelegate;return!n||typeof n!="function"?$(i.targetSelector).closest("form").serialize():n()},this.beforeAjax=function(n){i.delegateBeforeAjax&&typeof i.delegateBeforeAjax=="function"&&i.delegateBeforeAjax(n)},this.done=function(n){$(i.targetSelector)&&($(i.targetSelector).empty(),$(i.targetSelector).html(n));i.delegateSuccess&&typeof i.delegateSuccess=="function"&&i.delegateSuccess(n)},this.fail=function(n){console.log("erreur AJAX DasAjaxReload : "+JSON.stringify(n));Notification.Create("Erreur AJAX DasAjaxReload",Notification.Ko);i.delegateError&&typeof i.delegateError=="function"&&i.delegateError(n)},this.reload=function(){var n,t;(r.beforeAjax(this),n=r.GetAjaxUrl(),n)&&(console.log(this.id+" has triggered a DasAjaxReload for "+n),t=r.GetData(),$.ajax(n,{type:i.ajaxType,dataType:i.ajaxDataType,cache:!1,data:t}).done(r.done).fail(r.fail))},i.triggerChangeSeletors||i.execute)){for(f=i.triggerChangeSeletors,s=f.length,u=0;u<s;u++){e=f[u];o="change";$(e).data("dasAutocompleteText")&&(o="autocompleteChange");n.on(o,e,r.reload)}i.execute&&r.reload()}};jQuery.fn.extend({DasAjaxReload:function(n){return n?new DasAjaxReload($(this),n):undefined}});var DasSearchFromSessionStorage=function(){var n=function(n){this.sessionKey=n||"dasSearchMemory"};return n.prototype.Save=function(n){window.sessionStorage.setItem(this.sessionKey,JSON.stringify(n))},n.prototype.TryLoad=function(n){var t=JSON.parse(window.sessionStorage.getItem(this.sessionKey));return t?(n._entite=t._entite,n._search=t._search,n._mode=t._mode,n._template=t._template,!0):!1},n}(),DasSearchFromUrl=function(){var n={entite:"entite",template:"template",search:"search"},t={_entite:{urlParam:"entite"},_template:{urlParam:"template"},_search:{urlParam:"search"},_mode:{selector:"#mode",defaultValue:"Simple"}},i=function(i){var r,u;this.tobeSave=!1;r=this;for(u in t)Object.defineProperty(r,u,{get:function(){var n=t[u],e=n.hasOwnProperty("defaultValue")?n.defaultValue:"",f=getFuncFromSettingsOrDefault(n,"getValue",function(n){return n}),i=null;return n.hasOwnProperty("urlParam")?i=UrlUtils.getURLParameter(n.urlParam):n.hasOwnProperty("selector")&&(i=$(n.selector).DASValue(),n.hasOwnProperty("container")&&(i=$(n.container).find(n.selector).DASValue())),i?(r.tobeSave=!0,f(i)):f(e)}});$.extend(n,i)};return i.prototype.TryLoad=function(t){var i,u,f,r;return window.location.pathname.indexOf("Recherche")===-1?!1:(i=!1,u=UrlUtils.getURLParameter(n.entite),u===null?t._entite="":(i=!0,t._entite=u),f=UrlUtils.getURLParameter(n.template),f===null?t._template="":(i=!0,t._template=f),r=UrlUtils.getURLParameter(n.search),r===null||r===undefined?t._search="":(i=!0,t._search=decodeURIComponent(r)),t._mode=$("#mode").val(),t._mode===null&&(t._mode="Simple"),i)},i}(),DasSearchData=function(){var n=function(){this._entite=null;this._search=null;this._mode=null;this._template=null};return n.prototype.SetValues=function(n){n&&(this._entite=n._entite,this._search=n._search,this._mode=n._mode,this._template=n._template)},n}(),DasSessionSearch=function(){return function(n){console.log("new DasSessionSearch");this._data=new DasSearchData;this._searchFromUrl=new DasSearchFromUrl;this._searchFormSessionStorage=new DasSearchFromSessionStorage;this._searchFromUrl.TryLoad(this._data)?this._searchFormSessionStorage.Save(this._data):this._searchFormSessionStorage.TryLoad(this._data);n&&n(this._data)}}(),DasTrackingModificationOptions=function(){return{enable:!0,cssClassTracking:"",cssClassNoTracking:"dasNoTrack",cssClassChanged:"control-changed",message_Oui:"Rester sur cette page",message_Non:"Quitter sur cette page",message_Titre:"Title",message_Contenu:"",forceShowMessage:!1}},DasTrackingModification=function(){"use strict";this.modified=!1;this.option=null;this.beforeUnloadCallBack=null;this.Init=function(n,t){this.option=n;this.beforeUnloadCallBack=t;DasTrackingModification.SaveDefaultValue(this)};this.CheckModification=function(n){if(!this.option.enable||$(n.currentTarget).not(".pager-btn-next, .pager-btn-previous, .pager-btn-first, .pager-btn-last .delete-button, .delete-button-disabled, .action-disabled, .button-supprimer, .button-compare, .dasNoTrack").length===0||$(n.currentTarget).hasClass(this.option.cssClassNoTracking))return!1;var t;switch(n.type){case"click":if(n.originalEvent!==null&&n.originalEvent.button!==0||n.originalEvent!==null&&n.originalEvent.button===0&&n.originalEvent.ctrlKey||n.currentTarget!==null&&n.currentTarget.href.indexOf("javascript")===0||n.currentTarget!==null&&$(n.currentTarget).attr("data-ajax"))return!1;t=n.currentTarget;n.preventDefault()}return this.modified=!1,DasTrackingModification.CheckInputs(this),DasTrackingModification.CheckDataTable(this),t&&(this.modified||this.option.forceShowMessage?DasTrackingModification.Show(t,this):DasTrackingModification.ApplyLink(t)),this.modified|this.option.forceShowMessage};DasTrackingModification.SaveDefaultValue=function(n){var t=n,i;i=t.option.cssClassTracking?"form."+t.option.cssClassTracking+" select[class!="+t.option.cssClassNoTracking+"]":"form select[class!="+t.option.cssClassNoTracking+"]";$(i).each(function(n,t){$(t).prop("defaultOption",$(t).val())})};DasTrackingModification.UpdateChangedControl=function(n,t){switch(n.type){case"checkbox":$(n).parents("div.checkbox-container").addClass(t.option.cssClassChanged);break;default:$(n).addClass(t.option.cssClassChanged)}};DasTrackingModification.UpdateUnChangedControl=function(n,t){switch(n.type){case"checkbox":$(n).parents("div.checkbox-container").removeClass(t.option.cssClassChanged);break;default:$(n).removeClass(t.option.cssClassChanged)}};DasTrackingModification.ApplyLink=function(n){$(window).unbind("beforeunload",this.beforeUnloadCallBack);var t=$(n).attr("href");if(t){window.location=t;return}};DasTrackingModification.PrepareDialogDiv=function(n){$("#dialog-modificationUnderway").remove();var t=document.createElement("div");t.title=formatToHtml(n.option.message_Titre);t.id="dialog-modificationUnderway";$(t).html(n.option.message_Contenu);$("body").append($(t))};DasTrackingModification.Show=function(n,t){var i=[];i[1]={text:t.option.message_Non,click:function(){$(this).dialog("close");DasTrackingModification.ApplyLink(n,t)}};i[0]={text:t.option.message_Oui,click:function(){$(this).dialog("close")}};DasTrackingModification.PrepareDialogDiv(t);$("#dialog-modificationUnderway").dialog({resizable:!1,height:"auto",width:"auto",modal:!0,title:t.option.message_Titre,buttons:i})};DasTrackingModification.CheckDataTable=function(n){var t=n;($("form[dasNoTrack!=true] .deleted").length>0||$("form[dasNoTrack!=true] .added").length>0)&&(t.modified=!0)};DasTrackingModification.CheckInputs=function(n){var t=n,i,r,u;t.option.cssClassTracking?(i="form."+t.option.cssClassTracking+" input[class!="+t.option.cssClassNoTracking+"]",r="form."+t.option.cssClassTracking+" select[class!="+t.option.cssClassNoTracking+"]",u="form."+t.option.cssClassTracking+" textarea[class!="+t.option.cssClassNoTracking+"]"):(i="form[dasNoTrack!=true] input[class!="+t.option.cssClassNoTracking+"]",r="form[dasNoTrack!=true] select[class!="+t.option.cssClassNoTracking+"]",u="form[dasNoTrack!=true] textarea[class!="+t.option.cssClassNoTracking+"]");$(i+", "+u).each(function(i,r){if($(r).is(":visible"))switch($(r).prop("type")){case"hidden":break;case"radio":case"checkbox":$(r).prop("defaultChecked")!==$(r).prop("checked")?(t.modified=!0,console.log($(r)),DasTrackingModification.UpdateChangedControl(r,t)):DasTrackingModification.UpdateUnChangedControl(r,n);break;default:$(r).prop("defaultValue")!==$(r).val()?(t.modified=!0,console.log($(r)),DasTrackingModification.UpdateChangedControl(r,t)):DasTrackingModification.UpdateUnChangedControl(r,n)}});$(r).each(function(i,r){$(r).is(":visible")&&($(r).prop("defaultOption")!==$(r).val()?(t.modified=!0,console.log($(r)),DasTrackingModification.UpdateChangedControl(r,t)):DasTrackingModification.UpdateUnChangedControl(r,n))})}},UrlUtils={addOrUpdateParameter:function(n,t,i){if(n.indexOf(t+"=")>=0){var u=n.substring(0,n.indexOf(t)),r=n.substring(n.indexOf(t));r=r.substring(r.indexOf("=")+1);r=r.indexOf("&")>=0?r.substring(r.indexOf("&")):"";n=u+t+"="+i+r}else n+=n.indexOf("?")<0?"?"+t+"="+i:"&"+t+"="+i;return n},getURLParameter:function(n,t){var r,u,i,f;if(t||(t=n,n=window.location.href),r=n.indexOf("?")>-1?n.split("?")[1]:null,!r)return null;for(u=r.split("&"),i=0;i<u.length;i++)if(f=u[i].split("="),f[0]===t)return f[1];return null}};
//# sourceMappingURL=DAS-All.min.js.map
